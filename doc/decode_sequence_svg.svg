<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1638px" preserveAspectRatio="none" style="width:3881px;height:1638px;" version="1.1" viewBox="0 0 3881 1638" width="3881.5px" zoomAndPan="magnify"><defs><filter height="300%" id="fw6g548j14tgg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="7.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="14.0" dy="14.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1587.4653" style="stroke: #A80036; stroke-width: 3.5;" width="3757.25" x="66.5" y="14"/><text fill="#000000" font-family="sans-serif" font-size="45.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="441" x="1724.625" y="66.1428">Decoder Procession</text><rect fill="#FFFFFF" filter="url(#fw6g548j14tgg)" height="402.6418" style="stroke: #000000; stroke-width: 7.0;" width="3799.25" x="45.5" y="995.4031"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 5.0,5.0;" x1="395.5" x2="395.5" y1="223.5608" y2="1457.5449"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 5.0,5.0;" x1="1375.5" x2="1375.5" y1="223.5608" y2="1457.5449"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 5.0,5.0;" x1="2847.25" x2="2847.25" y1="223.5608" y2="1457.5449"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 5.0,5.0;" x1="3501.75" x2="3501.75" y1="223.5608" y2="1457.5449"/><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="616" x="80.5" y="90.1404"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="567" x="105" y="170.7942">MinaCodecDecoderChain</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="616" x="80.5" y="1454.0449"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="567" x="105" y="1534.6987">MinaCodecDecoderChain</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="504" x="1116.5" y="90.1404"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="455" x="1141" y="170.7942">ByteContractFactory</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="504" x="1116.5" y="1454.0449"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="455" x="1141" y="1534.6987">ByteContractFactory</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="612.5" x="2535.75" y="90.1404"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="563.5" x="2560.25" y="170.7942">GeneralSegmentDecoder</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="612.5" x="2535.75" y="1454.0449"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="563.5" x="2560.25" y="1534.6987">GeneralSegmentDecoder</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="598.5" x="3197.25" y="90.1404"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="549.5" x="3221.75" y="170.7942">MinaCodecBodyDecoder</text><rect fill="#FEFECE" filter="url(#fw6g548j14tgg)" height="115.9204" style="stroke: #A80036; stroke-width: 5.25;" width="598.5" x="3197.25" y="1454.0449"/><text fill="#000000" font-family="sans-serif" font-size="49" lengthAdjust="spacingAndGlyphs" textLength="549.5" x="3221.75" y="1534.6987">MinaCodecBodyDecoder</text><polygon fill="#A80036" points="353.5,327.7012,388.5,341.7012,353.5,355.7012,367.5,341.7012" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="10.5" x2="374.5" y1="341.7012" y2="341.7012"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="287" x="35" y="324.7036">byte message</text><polygon fill="#A80036" points="1333.5,438.8416,1368.5,452.8416,1333.5,466.8416,1347.5,452.8416" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="395.5" x2="1354.5" y1="452.8416" y2="452.8416"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="567" x="420" y="435.844">assembleHeader(IoBuffer in)</text><polygon fill="#A80036" points="2807,549.9819,2842,563.9819,2807,577.9819,2821,563.9819" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="1375.5" x2="2828" y1="563.9819" y2="563.9819"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="1389.5" x="1400" y="546.9844">decodeSegment(IoBuffer in, ByteContractProtocolSegment segment)</text><polygon fill="#A80036" points="1414,661.1223,1379,675.1223,1414,689.1223,1400,675.1223" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 2.0,2.0;" x1="1393" x2="2845.5" y1="675.1223" y2="675.1223"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="318.5" x="1435" y="658.1248">headerSegment</text><polygon fill="#A80036" points="434,772.2627,399,786.2627,434,800.2627,420,786.2627" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 2.0,2.0;" x1="413" x2="1372" y1="786.2627" y2="786.2627"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="231" x="455" y="769.2651">headerData</text><line style="stroke: #A80036; stroke-width: 3.5;" x1="395.5" x2="542.5" y1="897.4031" y2="897.4031"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="542.5" x2="542.5" y1="897.4031" y2="942.9031"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="399" x2="542.5" y1="942.9031" y2="942.9031"/><polygon fill="#A80036" points="434,928.9031,399,942.9031,434,956.9031,420,942.9031" style="stroke: #A80036; stroke-width: 3.5;"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="931" x="420" y="880.4055">get protocal handler and length from headData</text><path d="M45.5,995.4031 L301,995.4031 L301,1026.9031 L266,1061.9031 L45.5,1061.9031 L45.5,995.4031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 3.5;"/><rect fill="none" height="402.6418" style="stroke: #000000; stroke-width: 7.0;" width="3799.25" x="45.5" y="995.4031"/><text fill="#000000" font-family="sans-serif" font-size="45.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="98" y="1051.0459">loop</text><text fill="#000000" font-family="sans-serif" font-size="38.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="1291.5" x="353.5" y="1046.5239">[尝试用Decoder进行解析，直至解析成功，写回ProtocalDecoderOutput]</text><polygon fill="#A80036" points="3461.5,1133.7642,3496.5,1147.7642,3461.5,1161.7642,3475.5,1147.7642" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="395.5" x2="3482.5" y1="1147.7642" y2="1147.7642"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="1603" x="420" y="1130.7666">doDecodeBody(IoSession session, short handler, int contentLength, IoBuffer in)</text><polygon fill="#A80036" points="434,1244.9045,399,1258.9045,434,1272.9045,420,1258.9045" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5; stroke-dasharray: 2.0,2.0;" x1="413" x2="3500" y1="1258.9045" y2="1258.9045"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="192.5" x="455" y="1241.907">bodyData</text><polygon fill="#A80036" points="3461.5,1356.0449,3496.5,1370.0449,3461.5,1384.0449,3475.5,1370.0449" style="stroke: #A80036; stroke-width: 3.5;"/><line style="stroke: #A80036; stroke-width: 3.5;" x1="395.5" x2="3482.5" y1="1370.0449" y2="1370.0449"/><text fill="#000000" font-family="sans-serif" font-size="45.5" lengthAdjust="spacingAndGlyphs" textLength="2649.5" x="420" y="1353.0474">writeObjectToSession(IoSession session, ProtocolDecoderOutput output,ByteContractSegmentData headerData, Object bodyData)</text><!--
@startuml
box "Decoder Procession"
[->MinaCodecDecoderChain:byte message
MinaCodecDecoderChain -> ByteContractFactory:assembleHeader(IoBuffer in)
ByteContractFactory -> GeneralSegmentDecoder:decodeSegment(IoBuffer in, ByteContractProtocolSegment segment)
GeneralSegmentDecoder- ->ByteContractFactory : headerSegment
ByteContractFactory - -> MinaCodecDecoderChain : headerData
MinaCodecDecoderChain -> MinaCodecDecoderChain: get protocal handler and length from headData
loop 尝试用Decoder进行解析，直至解析成功，写回ProtocalDecoderOutput
  MinaCodecDecoderChain -> MinaCodecBodyDecoder:doDecodeBody(IoSession session, short handler, int contentLength, IoBuffer in)
  MinaCodecBodyDecoder - -> MinaCodecDecoderChain:bodyData
  MinaCodecDecoderChain -> MinaCodecBodyDecoder:writeObjectToSession(IoSession session, ProtocolDecoderOutput output,ByteContractSegmentData headerData, Object bodyData)
end
end box
@enduml

PlantUML version 1.2018.11(Sun Sep 23 00:43:53 CST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b28
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>